<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Chronostasis</title>
  <link href="style.css" rel="stylesheet" type="text/css" />
  <script src="https://d3js.org/d3.v4.js"></script>
</head>

<style>

  .line {
    fill: none;
    stroke: rgb(45, 165, 195);
    stroke-width: 2px;
  }

  .axisWhite line{
    stroke: rgb(240,240,240);
  }

  .axisWhite path{
    stroke: rgb(240,240,240);
  }

  .axisWhite text{
    fill: rgb(240,240,240);
  }

  </style>

<body>
    <div id="main">

    <div class="question">
      <h1>My <span class="magic-text">Question</span></h1>
      <h2>
          <span class="magic-text">Chronostasis</span> - What percentage of people have experienced it, and how does it scale with the speed of an eye movement?
      </h2>
    </div>

    <div class="content">
      <h1>My <span class="magic-text">Data</span></h1>
      <p>
          My data was taken from a dataset at a hospital where patients had their eye movements tracked and recorded.
          The full dataset can be found <a href="https://github.com/bsilver3/DataScience1/blob/main/Projects/FinalProject/SaccadesDataset.csv" target=”_blank”>here</a>.
      </p>
    </div>

    <div class="content">
      <h1>My <span class="magic-text">Analysis</span></h1>
      <p>
        <div id="cards">
          <div class="card">
            <div class="card-content">
              <div class="card-info-wrapper">
                <div class="card-info">
                  <div class="card-info-title">
                    <h3><span class="magic-text">230.0</span> Median Velocity</h3>
                    <h4>Velocity represents the speed of the eye movement. This shows that generally, a person's eye (with resistance for outliers) moving from point to point during the experiment moves at a fairly large speed.                          </h4>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="card">
            <div class="card-content">
              <div class="card-info-wrapper">
                <div class="card-info">
                  <div class="card-info-title">
                    <h3><span class="magic-text">2.75</span> Median Amplitude</h3>
                    <h4>Amplitude represents the force or pressure of an eye movement. This shows that generally, a person's eye (with resistance for outliers) moving from point to point during the experiment moves at a fairly forceful rate, and will generally have to correct for moving past the point.</h4>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="card">
            <div class="card-content">
              <div class="card-info-wrapper">
                <div class="card-info">
                  <div class="card-info-title">
                    <h3><span class="magic-text">1.84%</span> of people experienced chronostasis</h3>
                    <h4>This shows that in regular life (this dataset was just simple eye testing at a hospital), the probability of actually experiencing chronostasis is fairly low. However, this can be easily manipulated by intensely focusing on a point, and then quickly shifting your focus to another object, such as a clock. If the second hand seems to freeze for a second, then you have experienced a form of chronostasis.</h4>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </p>
    </div>

    <div class="content">
      <h1>My <span class="magic-text">Visualizations</span></h1>

      <div id="scatterplot" style="text-align: center;"></div>
      <script>

        var margin = {top: 10, right: 30, bottom: 30, left: 30},
          width = 460 - margin.left - margin.right,
          height = 400 - margin.top - margin.bottom;

        var SVG = d3.select("#scatterplot")
          .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
          .append("g")
            .attr("transform",
                  "translate(" + margin.left + "," + margin.top + ")");

        d3.csv("https://raw.githubusercontent.com/bsilver3/DataScience1/main/Projects/FinalProject/SaccadesDataset.csv", function(data) {

          SVG.append("text")
            .attr("text-anchor", "end")
            .attr("x", width)
            .attr("y", height - 6)
            .text("Velocity");

          SVG.append("text")
            .attr("text-anchor", "end")
            .attr("y", 6)
            .attr("dy", ".75em")
            .attr("transform", "rotate(-90)")
            .text("Amplitude");

          d3.selectAll("text").attr("fill", "white");

          var x = d3.scaleLinear()
            .domain([0, 3500])
            .range([ 0, width ]);
          var xAxis = SVG.append("g")
            .attr("transform", "translate(0," + height + ")")
            .attr("class", "axisWhite")
            .call(d3.axisBottom(x));

          var y = d3.scaleLinear()
            .domain([0, 50])
            .range([ height, 0]);
          var yAxis = SVG.append("g")
            .attr("class", "axisWhite")
            .call(d3.axisLeft(y));

          var clip = SVG.append("defs").append("SVG:clipPath")
            .attr("id", "clip")
            .append("SVG:rect")
            .attr("width", width )
            .attr("height", height )
            .attr("x", 0)
            .attr("y", 0);

          var scatter = SVG.append('g')
            .attr("clip-path", "url(#clip)")

          var tooltip = d3.select("#scatterplot")
            .append("div")
            .style("opacity", 0)
            .attr("class", "tooltip")
            .style("background-color", "rgb(25,25,25)")
            .style("width", "175px")
            .style("border", "solid")
            .style("z-index", "50000")
            .style("border-width", "1px")
            .style("border-radius", "5px")
            .style("padding", "10px")

          var mouseover = function(d) {
            tooltip
              .style("opacity", 1)
              // .style("position", "absolute")
              .style("left", (d3.mouse(this)[0]+90) + "px")
              .style("top", (d3.mouse(this)[1]) + "px")
          }

          var mousemove = function(d) {
            tooltip
              .html("Velocity: " + d.Velocity + "<br>Amplitude: " + d.Amplitude)
              .style("left", (d3.mouse(this)[0]+90) + "px")
              .style("top", (d3.mouse(this)[1]) + "px")
          }

          var mouseleave = function(d) {
            tooltip
              .transition()
              .duration(200)
              .style("opacity", 0)
          }

          scatter
            .selectAll("circle")
            .data(data.filter(function(d,i){return i<20000}))
            .enter()
            .append("circle")
              .attr("cx", function (d) { return x(d.Velocity); } )
              .attr("cy", function (d) { return y(d.Amplitude); } )
              .attr("r", 5)
              .style("fill", "rgb(45, 165, 195)")
              .style("opacity", 0.5)
            .on("mouseover", mouseover )
            .on("mousemove", mousemove )
            .on("mouseleave", mouseleave )

          var zoom = d3.zoom()
            .scaleExtent([.5, 20])  // This control how much you can unzoom (x0.5) and zoom (x20)
            .extent([[0, 0], [width, height]])
            .on("zoom", updateChart);

          SVG.append("rect")
            .attr("width", width)
            .attr("height", height)
            .style("fill", "none")
            .style("pointer-events", "all")
            .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')
            .call(zoom);

          function updateChart() {

            // recover the new scale
            var newX = d3.event.transform.rescaleX(x);
            var newY = d3.event.transform.rescaleY(y);

            // update axes with these new boundaries
            xAxis.call(d3.axisBottom(newX))
            yAxis.call(d3.axisLeft(newY))

              // update circle position
            scatter
              .selectAll("circle")
              .attr('cx', function(d) {return newX(d.Velocity)})
              .attr('cy', function(d) {return newY(d.Amplitude)});
          }
        })
        </script>
    </div>

    <div class="content">
      <h1>My <span class="magic-text">Answer</span></h1>
      <p>
          Chronostasis is a phenomenon where it feels like you are “stopped in time”. 
          This generally occurs when your brain has to overcorrect after an eye movement. 
          When analyzing the data, we can see that there is a positive association between velocity and amplitude, 
          meaning that the faster somebody moves their eye, the more likely they are to experience a chronostasis phenomenon, 
          due to their eye using more force and having to overcorrect. I calculated the amount of people with an amplitude above 20.0, 
          which is the amplitude that it generally takes to have a substantial amount of correction in the brain. 
          I then calculated the percentage of people who had the experience of chronostasis, 
          and I found that 1.84% of people experience chronostasis in daily life. 
          However, this can easily be manipulated by intensely focusing on a point, and then quickly shifting your focus to another object, 
          such as a clock. If the second hand seems to freeze for a second, then you have experienced a form of chronostasis.
      </p>
    </div>
  </div>
</body>

<script src="script.js"></script>